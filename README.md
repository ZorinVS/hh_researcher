# hh_researcher

## Описание

Проект hh_researcher представляет собой утилиту для взаимодействия с API HeadHunter, которая позволяет 
получать информацию о вакансиях на основе заданных ключевых слов и города. Он позволяет собирать информацию 
о вакансиях, проводить валидацию данных, сортировать вакансии по зарплате и выводить топ-N вакансий на основе 
их зарплат. Проект предназначен для упрощения процесса поиска и анализа информации о вакансиях.

## Основные возможности

- Сбор данных из HeadHunter: Модуль hh_api.py предоставляет функционал для взаимодействия с API HeadHunter и получения информации о вакансиях.
- Анализ и парсинг данных: Модуль parser.py отвечает за обработку и парсинг данных, полученных из API.
- Валидация данных: Модуль validator.py включает в себя различные валидаторы для проверки корректности данных, таких как название вакансии, URL, требования, зарплата и локация размещения вакансии.
- Управление вакансиями: Модули base_vacancy.py и vacancy.py обеспечивают управление и работу с объектами вакансий.
- Сохранение данных: Модули base_vacancy_saver.py, vacancy_saver.py реализуют функционал для сохранения вакансий в файл, удаления и получения данных о вакансиях из файла, а также обработки исключений, связанных с уже существующими вакансиями.
- Сортировка и вывод вакансий: Модули sort_utility.py и top_n_utility.py позволяют сортировать вакансии по зарплате и выводить топ-N вакансий.
- Обработка исключений: Модуль vacancy_already_exists_error.py реализует собственное исключение для случаев, когда вакансия уже существует в файле.


## Функциональность

hh_researcher включает следующие модули:

- main.py
- hh_api.py
- parser.py
- base_vacancy_saver.py
- vacancy_saver.py
- sort_utility.py
- top_n_utility.py
- utils.py
- validator.py
- vacancy.py
- vacancy_already_exists_error.py

### Обзор функциональных модулей:

#### main.py

Основной модуль, обеспечивающий запуск приложения и демонстрацию работы с объектами.

#### hh_api.py

Модуль hh_api.py предоставляет реализацию класса HH, который наследуется от абстрактного класса Parser 
и предназначен для работы с API HeadHunter. Этот класс позволяет подключаться к API, выполнять поиск вакансий 
по ключевому слову и городу, а также определять ID города. В модуле представлены следующие методы:

- `__init__`: Инициализация объекта для взаимодействия с API.
- `_connect_to_api`: Проверка успешности подключения к API.
- `get_vacancies`: Получение списка вакансий по заданным параметрам, включая фильтрацию по зарплате и городу.
- `_get_area_id`: Получение ID города на основе его названия с учетом возможных вариаций написания.

### parser.py

Модуль parser.py содержит абстрактный класс Parser, который определяет интерфейс для работы с API HeadHunter. 
Этот класс служит базовым для создания различных парсеров, обеспечивающих подключение к API, получение вакансий 
по заданным параметрам и определение ID города. В модуле реализованы следующие методы:

- `__init__`: Инициализация объекта парсера.
- `_connect_to_api`: Проверка подключения к API.
- `get_vacancies`: Получение списка вакансий на основе ключевого слова и города.
- `_get_area_id`: Определение ID города по его названию.

### base_vacancy_saver.py

Модуль base_vacancy_saver.py предоставляет абстрактный класс VacancySaver, который служит базой для реализации 
функционала работы с файлами для сохранения, удаления и получения данных о вакансиях. Этот модуль используется для 
создания различных реализаций хранения вакансий, которые могут быть применены в разных форматах файлов. В модуле 
реализованы следующие методы:

- `add_vacancy`: Абстрактный метод для добавления объекта вакансии в файл.
- `delete_vacancy`: Абстрактный метод для удаления объекта вакансии из файла.
- `get_vacancies`: Абстрактный метод для загрузки данных о вакансиях из файла и их возвращения в виде словаря.

### vacancy_saver.py

Модуль vacancy_saver.py реализует класс VacancyJSON, который наследуется от абстрактного класса VacancySaver и 
предоставляет методы для работы с вакансиями, сохраняемыми в формате JSON. Этот модуль позволяет сохранять вакансии 
в файл, удалять их и загружать данные для дальнейшего использования. В модуле представлены следующие методы:

- `add_vacancy`: Метод для добавления объекта вакансии в JSON-файл. Проверяет, нет ли уже такой вакансии, чтобы избежать дублирования.
- `delete_vacancy`: Метод для удаления объекта вакансии из JSON-файла, освобождая ID вакансии.
- `get_vacancies`: Метод для загрузки данных о вакансиях из JSON-файла. Может выводить вакансии в консоль, если передан соответствующий параметр.
- `print_vacancies`: Статический метод для вывода информации о вакансиях в консоль.
- `_read_file`: Метод для чтения данных из JSON-файла.
- `_write_file`: Метод для записи данных о вакансиях в JSON-файл.
- `file_path`: Свойство, возвращающее путь к используемому файлу.

### sort_utility.py

Модуль sort_utility.py содержит функции, которые используются для сортировки данных о вакансиях на основе зарплат. 
Он позволяет получать средние значения зарплат из строк и использовать их для сортировки вакансий по указанным 
критериям. Основные функции модуля:

- `avg_salary`: Функция, которая извлекает и рассчитывает среднее значение зарплаты из строки. Если в строке содержится диапазон значений, возвращает среднее значение, иначе возвращает единственное число.
- `get_salary`: Функция, используемая в качестве ключа для сортировки. Она получает среднее значение зарплаты из объекта вакансии и возвращает его для использования в функции sorted.
- `sort_by_salary`: Основная функция модуля, которая сортирует вакансии по зарплате. Принимает на вход список объектов вакансий и опционально параметр направления сортировки (по умолчанию сортирует от большего к меньшему). Возвращает список вакансий, отсортированных по зарплате.

### top_n_utility.py

Модуль top_n_utility.py предоставляет функции для работы с топом вакансий на основе их зарплат. Он позволяет 
пользователю выбрать количество топовых вакансий. Функция модуля:

- `get_top_vacancies`: Функция, которая запрашивает у пользователя количество топовых вакансий, которые необходимо получить из списка вакансий, отсортированных по зарплате. Возвращает список с выбранным количеством вакансий.

### utils.py

Модуль utils.py содержит функции, которые помогают в работе с данными, полученными от API, и в настройке параметров 
сохранения вакансий. Основные функции модуля:

- `get_salary`: Функция для подготовки информации о зарплате. Извлекает данные о минимальной и максимальной зарплате из словаря и возвращает строку с соответствующими значениями. Если ни одно из значений не указано, возвращает "0 руб."
- `create_list_of_vacancies`: Функция для создания списка объектов вакансий на основе данных, полученных от API. Инициализирует объекты вакансий с информацией о названии, URL, зарплате, городе и требованиях.
- `initialization_menu`: Функция, которая предлагает пользователю выбрать имя файла для сохранения вакансий. Можно использовать стандартное имя файла (vacancies.json) или задать своё.
- `search_menu`: Меню для выбора метода поиска вакансий (по всей России или в определённом городе). Использует API для выполнения поиска.
- `search_vacancies`: Вспомогательная функция для поиска вакансий. Выполняет запрос по указанным параметрам и выводит результаты, а также количество найденных вакансий.

### validator.py

Модуль validator.py содержит валидаторы для различных данных, связанных с вакансиями. Эти валидаторы обеспечивают 
проверку и корректность данных перед их использованием в приложении.

Классы:

- `Validator`: Абстрактный класс для всех валидаторов. Определяет метод validate, который должен быть реализован в каждом дочернем классе.
- `NameValidator`: Проверяет, что название вакансии не пустое.
- `URLValidator`: Проверяет, что URL вакансии корректен и начинается с https://.
- `RequirementsValidator`: Проверяет, что требования к вакансии указаны. Если требования не указаны, возвращает стандартное сообщение.
- `SalaryValidator`: Проверяет корректность указанной зарплаты, поддерживая как числовые значения, так и диапазоны.
- `AreaNameValidator`: Проверяет, что название города размещения вакансии указано. Если информация не указана, возвращает "Россия".
- `SearchValidator`: Проверяет наличие и формат названия города, возвращая его как список.

### vacancy.py

Модуль vacancy.py реализует класс Vacancy для представления вакансии. Определяет общие атрибуты вакансии, такие как название, URL, 
зарплата, город и требования. Также включает методы для сравнения вакансий по зарплате, удаления вакансии и 
получения строкового представления вакансии.

Класс:

`Vacancy`: Конкретный класс для представления информации о вакансии. Наследует все атрибуты и методы от BaseVacancy 
и предоставляет реализацию абстрактных методов.

Атрибуты:

- `_name`: Название вакансии.
- `_url`: URL вакансии.
- `_salary`: Зарплата, которая может быть строкой или числом.
- `_city`: Город.
- `_requirements`: Требования к вакансии.
- `name`, `url`, `salary`, `requirements`, `city`: Геттеры и сеттеры для работы с атрибутами вакансии.

Методы:

- - `__init__`: Инициализирует объект вакансии с валидацией данных.
- `_avg_salary`: Рассчитывает среднюю зарплату, если указаны диапазоны.
- `_validate_other`: Проверяет, что объект для сравнения также является экземпляром Vacancy.
- `__lt__`: Сравнивает вакансии по зарплате.
- `__str__`: Возвращает строковое представление объекта вакансии.

### vacancy_already_exists_error.py

Модуль содержит определение исключения, которое используется для обработки ошибок, связанных с попыткой добавления 
вакансии, которая уже существует в файле.

Классы:

`VacancyAlreadyExistsError`: Исключение, возникающее, если вакансия уже существует в файле.

Методы:

- `__init__`: Конструктор для инициализации исключения с опциональным сообщением. Если сообщение не указано, используется стандартное сообщение "Вакансия уже существует в файле."
- `__str__`: Метод для возвращения строкового представления исключения.

## Зависимости

- Python 3.12
- flake8 7.1.1
- isort 5.13.2
- black 24.8.0
- mypy 1.11.2
- pytest 8.3.2
- pytest-cov 5.0.0
- requests 2.32.3
- types-requests = 2.32.0.20240712

## Установка

1. Клонируйте репозиторий:
```bash
git clone git@github.com:ZorinVS/hh_researcher.git
```
2. Установите зависимости:
```bash
poetry install
```

## Тестирование проекта

Тестирование проекта проводится с использованием пакета tests, который включает следующие файлы:

- init.py
- conftest.py
- test_hh_api.py
- test_top_n_utility.py
- test_utils.py
- test_vacancy.py
- test_vacancy_json.py

### Есть два способа выполнить тестирование проекта:
1. Используя терминал PyCharm:
```bash
pytest tests
```
2. Используя функциональность PyCharm:
- Откройте окно **Edit Configurations**.
- Выберите **pytest**.
- Укажите директорию, содержащую тесты, и директорию проекта.
- Подтвердите изменения, нажав **Apply** и **OK**.
- Запустите **pytest in tests**

## Документация

Для получения дополнительной информации, пожалуйста, свяжитесь с...

## Лицензия

Этот проект лицензирован в соответствии с условиями [MIT License](LICENSE).
